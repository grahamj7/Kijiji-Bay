
<!DOCTYPE html>
<html>
<head>
    <!--JD CMPT350 Project: Free Classifieds in Saskatoon. Find a job, buy a car, find a house or apartment, furniture, appliances and more!-->
    <title>JD CMPT350 Project</title>
    <link rel="shortcut icon" type="image/x-icon" href="Images/favicon.ico" />

    <link rel="stylesheet" type="text/css" href="jquery/jquery.mobile.custom.structure.css">
    <link rel="stylesheet" type="text/css" href="jquery/jquery.mobile.custom.structure.min.css">
    <link rel="stylesheet" type="text/css" href="jquery/jquery.mobile.custom.theme.css">
    <link rel="stylesheet" type="text/css" href="jquery/jquery.mobile.custom.theme.min.css">
    <link rel="stylesheet" type="text/css" href="styling.css">

    <script type="javascript">
        //todo find new flashy image for title of website
        //todo go through css's and filter out the crap
        //todo get icons for categories
    </script>
    <script type="text/javascript" src="index.js"></script>
    <script type="text/javascript" src="arrayDB.js"></script>
</head>

<body>

<header>
    <div id="TopHeader">
        <div id="HeaderLeft">
            <a href="index.html"><image src="Images/favicon.ico"></image></a>
        </div>
        <div id="HeaderRight">
            <ul id="HeaderRightTop">
                <li><a href="signIn.html" rel="nofollow">Sign In<span style="padding-right: 50px"></span></a></li>
                <li><a href="register.html" rel="nofollow">Register<span style="padding-right: 30px"></span></a></li>
            </ul>
            <div id="HeaderRightBottom">
                <a class="button-header-nav first" href="postAd.html" rel="nofollow">
                    <strong>Post Ad</strong></a><a class="button-header-nav last" href="myProfile.html" rel="nofollow">
                My Profile</a>
            </div>
        </div>
    </div>

    <div id="HeaderBar">
    </div>
</header>

<div data-role="content">
    <h1>Register</h1>
    <form action="myProfile.html" onsubmit="return checkForm(this)">
        <fieldset>
            <label for="fName">First Name: <input name="form" type="text" id="fName" required></label><br>
            <label for="lName">Last Name: <input name="form" type="text" id="lName" required></label><br>
            <label for="email">Email: <input type="email" name="form" id="email" required></label><br>
            <label for="Opass">Password: <input type="password" name="form" id="Opass" required></label><br>
            <label for="Cpass">Confirm Password: <input type="password" name="form" id="Cpass" required></label><br>
            <label for="phone">Phone Number ex.555-123-4567: <input name="form" type="tel" required id="phone"></label><br>
            <label for="address">Address: <input type="text" name="form" id="address" required></label><br>
            <label for="city">City: <input type="text" name="form" id="city" required></label><br>
            <label for="prov">Province: </label>
            <select id="prov" required name="form">
                <option></option>
                <option>BC</option>
                <option>AB</option>
                <option>SK</option>
                <option>MB</option>
                <option>ON</option>
                <option>QC</option>
                <option>NS</option>
                <option>PE</option>
                <option>NB</option>
                <option>NL</option>
                <option>YT</option>
                <option>NW</option>
                <option>NU</option>
            </select><br>
            <label for="postal">Postal Code ex.A1B2C3: <input type="text" name="form" id="postal" required></label><br><br>
            <input type="submit">
        </fieldset>
    </form>
</div>

<div id="LayoutFooter">
    <footer>
        <div id="FooterBottom">
            <section style="min-width: 33%; max-width:50%; padding-left: 20%;">
                <ul style="list-style-type: none">
                    <li>
                        <image style="cursor:pointer" onclick="window.open('https://www.facebook.com/AnotherSchoolProject')" src="Images/fbook.png"></image>
                        <a href="https://www.facebook.com/AnotherSchoolProject" target="_blank" rel="nofollow">Friend us on Facebook</a>
                    </li>
                </ul>
            </section>
            <section style="min-width: 33%; max-width:50%;">
                <ul style="list-style-type: none">
                    <li>
                        <!--suppress XmlUnboundNsPrefix -->
                        <fb:like style="vertical-align: -33px" href="https://www.facebook.com/AnotherSchoolProject" send="false" width="60" show_faces="false"></fb:like>
                    </li>
                </ul>
            </section>
        </div>
    </footer>
</div>
<script type="text/javascript">
    (function(d, s, id)
    {                   // like on facebook
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;

        js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";

        fjs.parentNode.insertBefore(js, fjs);
    }(document, "script", 'facebook-jssdk'));

    var labels = document.getElementsByTagName('label');
    for (var i = 0; i < labels.length; i++) {
        if (labels[i].htmlFor != '') {
            var elem = document.getElementById(labels[i].htmlFor);
            if (elem)
                elem.label = labels[i];
        }
    }


    function checkForm(form)
    {
        var re = /\W/;
        var email = form.email.value.replaceAll('@', '');
        email = email.replace('.', '');
        if(re.test(email))
        {
            alert("Error: We can't allow special characters in the emails!");
            form.email.focus();
            return false;
        }

        if(form.fName.value.length > 30)
        {
            alert("Error: FirstName must be less than 30 characters!");
            form.fName.focus();
            return false;
        }
        if(form.lName.value.length > 30)
        {
            alert("Error: LastName must be less than 30 characters!");
            form.lName.focus();
            return false;
        }

        var table = DB[1];
        var users = table[1];
        for(var i = 0; i < users.length; i++)
            if (form.username.value == users[i])
            {
                alert("Error: Username has already been taken!");
                form.username.focus();
                return false;
            }

        if(form.Opass.value != "" && form.Opass.value == form.Cpass.value)
        {
            if(form.Opass.value.length < 6 && form.Opass.value.length >= 20)
            {
                alert("Error: Password must contain at least 6 characters but be less than 20!");
                form.Opass.focus();
                return false;
            }
            if(form.Opass.value == form.username.value)
            {
                alert("Error: Password must be different from Username!");
                form.Opass.focus();
                return false;
            }
            re = /[0-9]/;
            if(!re.test(form.Opass.value))
            {
                alert("Error: password must contain at least one number (0-9)!");
                form.Opass.focus();
                return false;
            }
            re = /[a-z]/;
            if(!re.test(form.Opass.value))
            {
                alert("Error: password must contain at least one lowercase letter (a-z)!");
                form.Opass.focus();
                return false;
            }
            re = /[A-Z]/;
            if(!re.test(form.Opass.value))
            {
                alert("Error: password must contain at least one uppercase letter (A-Z)!");
                form.Opass.focus();
                return false;
            }
        }
        else
        {
            alert("Error: Please check that you've entered and confirmed your password!");
            form.Opass.focus();
            return false;
        }

        // regular expression to match only alphanumeric characters and spaces
        re = /\b[0-9]{3}-[0-9]{3}-[0-9]{4}\b/;

        // validation fails if the input doesn't match our regular expression
        if(!re.test(form.phone.value))
        {
            alert("Error: Phone number is badly formatted");
            form.phone.focus();
            return false;
        }
        // regular expression to match only alphanumeric characters and spaces
        re = /\b\w\d\w\d\w\d\b/;

        // validation fails if the input doesn't match our regular expression
        if(!re.test(form.postal.value))
        {
            alert("Error: Postal code is badly formatted");
            form.postal.focus();
            return false;
        }
        insertUser(form);
        return true;
    }

    function insertUser(form)
    {
        var fName = document.getElementById('fName').value;
        var lName = document.getElementById('lName').value;
        var username = document.getElementById('username').value;
        var password = document.getElementById('Opass').value;
        var age = document.getElementById('age').value;
        var email = document.getElementById('email').value;
        var phone = document.getElementById('phone').value;
        var address = document.getElementById('address').value;
        var city = document.getElementById('city').value;
        var prov = document.getElementById('prov').value;
        var postal = document.getElementById('postal').value;

        // todo insert into database
        var table = DB[1];
        table[0].push(form.username.value);
        table[1].push(form.Opass.value);
        table[2].push(form.email.value);
        table[3].push(form.fName.value);
        table[4].push(form.lName.value);
        table[5].push(form.address.value);
        table[6].push(form.postal.value);
        table[7].push(form.prov.value);
        table[8].push(form.phone.value);
        table[9].push(form.age.value);

        window.open('myProfile.html','_self');
    }
</script>

</body>
</html>
